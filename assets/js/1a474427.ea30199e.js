"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[252],{3905:(e,a,t)=>{t.d(a,{Zo:()=>p,kt:()=>m});var n=t(7294);function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){r(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function i(e,a){if(null==e)return{};var t,n,r=function(e,a){if(null==e)return{};var t,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(r[t]=e[t]);return r}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=n.createContext({}),d=function(e){var a=n.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},p=function(e){var a=d(e.components);return n.createElement(s.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},c=n.forwardRef((function(e,a){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=d(t),m=r,h=c["".concat(s,".").concat(m)]||c[m]||u[m]||o;return t?n.createElement(h,l(l({ref:a},p),{},{components:t})):n.createElement(h,l({ref:a},p))}));function m(e,a){var t=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var o=t.length,l=new Array(o);l[0]=c;var i={};for(var s in a)hasOwnProperty.call(a,s)&&(i[s]=a[s]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var d=2;d<o;d++)l[d]=t[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"},1856:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var n=t(7462),r=(t(7294),t(3905));const o={sidebar_position:8},l="Monitoring",i={unversionedId:"stake-pool/monitoring",id:"stake-pool/monitoring",title:"Monitoring",description:"Docker",source:"@site/docs/stake-pool/monitoring.md",sourceDirName:"stake-pool",slug:"/stake-pool/monitoring",permalink:"/guides/stake-pool/monitoring",draft:!1,editUrl:"https://github.com/orcada-io/guides/edit/master/docs/stake-pool/monitoring.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8},sidebar:"tutorialSidebar",previous:{title:"Slot Leader Node",permalink:"/guides/stake-pool/slot-leader-node"}},s={},d=[{value:"Docker",id:"docker",level:2},{value:"Prometheus",id:"prometheus",level:2},{value:"Create a directory for the image",id:"create-a-directory-for-the-image",level:3},{value:"Configure Prometheus",id:"configure-prometheus",level:3},{value:"Run the image",id:"run-the-image",level:3},{value:"Grafana",id:"grafana",level:2},{value:"Create a directory for the image",id:"create-a-directory-for-the-image-1",level:3},{value:"Run the image",id:"run-the-image-1",level:3},{value:"Configure Grafana",id:"configure-grafana",level:3},{value:"Add a data source",id:"add-a-data-source",level:4},{value:"Sample dashboards",id:"sample-dashboards",level:4},{value:"Import a dashboard",id:"import-a-dashboard",level:4},{value:"Install a Grafana plugin",id:"install-a-grafana-plugin",level:3},{value:"Resources",id:"resources",level:3}],p={toc:d};function u(e){let{components:a,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,o,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"monitoring"},"Monitoring"),(0,r.kt)("h2",{id:"docker"},"Docker"),(0,r.kt)("p",null,"Use the Synology DSM's Package Center to download and install Docker:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(2407).Z,width:"997",height:"573"})),(0,r.kt)("p",null,"The installation will create a Shared Folder called docker: ",(0,r.kt)("inlineCode",{parentName:"p"},"/volume1/docker")),(0,r.kt)("h2",{id:"prometheus"},"Prometheus"),(0,r.kt)("h3",{id:"create-a-directory-for-the-image"},"Create a directory for the image"),(0,r.kt)("p",null,"Connect (SSH) to the Synology NAS, you should see something like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"admin@nas-1:~$\n")),(0,r.kt)("p",null,"Create the directory for the Prometheus image:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /volume1/docker\nmkdir prometheus\n")),(0,r.kt)("h3",{id:"configure-prometheus"},"Configure Prometheus"),(0,r.kt)("p",null,"Create a configuration file for ",(0,r.kt)("strong",{parentName:"p"},"Prometheus"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"nano prometheus.yml\n")),(0,r.kt)("p",null,"And update it as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'global:\n  scrape_interval: 15s\n\n  external_labels:\n    monitor: "stake-pool-monitor"\n\nscrape_configs:\n  - job_name: "Prometheus"\n    scrape_interval: 5s\n    static_configs:\n      - targets: ["192.168.101.3:12798"]\n        labels:\n          alias: "Relay 1"\n          type: "cardano-node"\n      - targets: ["192.168.101.3:9100"]\n        labels:\n          alias: "Relay 1"\n          type: "node"\n      - targets: ["192.168.101.4:12798"]\n        labels:\n          alias: "Relay 2" \n          type: "cardano-node"\n      - targets: ["192.168.101.4:9100"]\n        labels:\n          alias: "Relay 2"\n          type: "node"\n      - targets: ["192.168.101.5:12798"]\n        labels:\n          alias: "Relay 3"\n          type: "cardano-node"\n      - targets: ["192.168.101.5:9100"]\n        labels:\n          alias: "Relay 3"\n          type: "node"\n      - targets: ["192.168.102.3:12798"]\n        labels:\n          alias: "Core Node 1"\n          type: "cardano-node"\n      - targets: ["192.168.102.3:9100"]\n        labels:\n          alias: "Core Node 1"\n          type: "node"\n')),(0,r.kt)("h3",{id:"run-the-image"},"Run the image"),(0,r.kt)("p",null,"Run Prometheus:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run -d --name=prometheus \\\n  -p 9090:9090 \\\n  -v /volume1/docker/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml \\\n  prom/prometheus  \n")),(0,r.kt)("h2",{id:"grafana"},"Grafana"),(0,r.kt)("h3",{id:"create-a-directory-for-the-image-1"},"Create a directory for the image"),(0,r.kt)("p",null,"Connect (SSH) to the Synology NAS, you should see something like:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"admin@nas-1:~$\n")),(0,r.kt)("p",null,"Create the directory for the Grafana image:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /volume1/docker\nmkdir grafana\n")),(0,r.kt)("h3",{id:"run-the-image-1"},"Run the image"),(0,r.kt)("p",null,"Run Grafana:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"docker run -d --name=grafana \\\n  -p 7001:3000 \\\n  -v /volume1/docker/grafana:/var/lib/grafana \\\n  grafana/grafana && \\\n  chown -R 472:472 /volume1/docker/grafana\n")),(0,r.kt)("p",null,"Navigate to:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"http://192.168.101.2:7001/login\n")),(0,r.kt)("p",null,"The default username is ",(0,r.kt)("strong",{parentName:"p"},"admin"),". The default password is ",(0,r.kt)("strong",{parentName:"p"},"admin"),"."),(0,r.kt)("p",null,"You should see something like:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(8754).Z,width:"1397",height:"525"})),(0,r.kt)("h3",{id:"configure-grafana"},"Configure Grafana"),(0,r.kt)("h4",{id:"add-a-data-source"},"Add a data source"),(0,r.kt)("p",null,"In the Grafana side menu select Configuration -> Data sources then click the ",(0,r.kt)("strong",{parentName:"p"},"Add data source")," button. "),(0,r.kt)("p",null,"Choose Prometheus:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(599).Z,width:"1396",height:"461"})),(0,r.kt)("p",null,"Enter the data source URL: ",(0,r.kt)("inlineCode",{parentName:"p"},"http://192.168.101.2:9090")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Note:")," The IP address for the Synology NAS is ",(0,r.kt)("inlineCode",{parentName:"p"},"192.168.101.2")," and the Prometheus port number is ",(0,r.kt)("inlineCode",{parentName:"p"},"9090"),"."),(0,r.kt)("p",null,"Then click the ",(0,r.kt)("strong",{parentName:"p"},"Save & test")," button."),(0,r.kt)("h4",{id:"sample-dashboards"},"Sample dashboards"),(0,r.kt)("p",null,"Pi Pool:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(7129).Z,width:"1907",height:"980"})),(0,r.kt)("p",null,"SNSKY Pool:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(6478).Z,width:"1016",height:"411"})),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Armada Alliance: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/armada-alliance/dashboards"},"Sample dashboards")),(0,r.kt)("li",{parentName:"ul"},"Pi Pool: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/alessandrokonrad/Pi-Pool/tree/master/monitoring"},"Sample dashboards")),(0,r.kt)("li",{parentName:"ul"},"SNSKY: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/sanskys/SNSKY"},"Sample dashboards"))),(0,r.kt)("h4",{id:"import-a-dashboard"},"Import a dashboard"),(0,r.kt)("p",null,"In the Grafana side menu select Dashboards then click the ",(0,r.kt)("strong",{parentName:"p"},"Import")," button."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Docker",src:t(9128).Z,width:"3028",height:"1304"})),(0,r.kt)("h3",{id:"install-a-grafana-plugin"},"Install a Grafana plugin"),(0,r.kt)("p",null,"Use the following command to run a Shell in the Grafana container:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sudo docker exec -it grafana bash\n")),(0,r.kt)("p",null,"You can use the ",(0,r.kt)("a",{href:"https://grafana.com/docs/grafana/latest/cli/",target:"_blank"},"Grafana CLI")," to install\nplugins."),(0,r.kt)("p",null,"For example, to install the ",(0,r.kt)("a",{href:"https://grafana.com/grafana/plugins/grafana-clock-panel/",target:"_blank"},"Grafana Clock")," panel use the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"grafana-cli plugins install grafana-clock-panel\n")),(0,r.kt)("h3",{id:"resources"},"Resources"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Prometheus docs: ",(0,r.kt)("a",{parentName:"li",href:"https://prometheus.io/docs/prometheus/latest/configuration/configuration/"},"Configuration")),(0,r.kt)("li",{parentName:"ul"},"Grafana docs: ",(0,r.kt)("a",{parentName:"li",href:"https://grafana.com/docs/grafana/latest/"},"Configuration")),(0,r.kt)("li",{parentName:"ul"},"Grafana docs: ",(0,r.kt)("a",{parentName:"li",href:"https://grafana.com/docs/grafana/latest/dashboards/"},"About Grafana dashboards")),(0,r.kt)("li",{parentName:"ul"},"Grafana docs: ",(0,r.kt)("a",{parentName:"li",href:"https://grafana.com/docs/grafana/latest/best-practices/"},"Best Practices"))))}u.isMDXComponent=!0},2407:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/dsm-docker-4bbadf5c1ab13f09139e0a0537be676b.png"},599:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/grafana-data-source-aff9e832a345c92e80c89b29b8dfb8ff.png"},9128:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/grafana-import-dashboard-fb1874c875baa7098a6dd486a88141f5.png"},7129:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/grafana-pi-pool-dashboard-55cbdd28508cd62938e7317a2e234d78.png"},6478:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/grafana-snsky-dashboard-837d3745eb1246897b19dd1b5558073f.png"},8754:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/grafana-welcome-5b8ebdd4391aedca8b97f84dc0875c24.png"}}]);